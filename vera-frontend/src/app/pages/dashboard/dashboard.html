<div class="p-8 space-y-6">

    <div class="flex items-center justify-between mb-4">
        <h1 class="text-3xl font-bold">Dashboard Vera</h1>

        <button
          class="text-sm border rounded px-3 py-1 hover:bg-gray-100"
          (click)="loadQuestions()"
        >
          üîÅ Actualiser
        </button>
        <button
        (click)="logout()"
        class="text-sm px-3 py-2 bg-red-500 text-white rounded hover:bg-red-600 transition"
      >
        Se d√©connecter
      </button>
      </div>
      
  
    <!-- Erreur -->
    <div *ngIf="error" class="p-3 rounded bg-red-100 text-red-700 text-sm">
      {{ error }}
    </div>
  
    <!-- Stats (toujours affich√©es, m√™me si c'est 0 partout au d√©but) -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <div class="border rounded-xl p-4">
        <div class="text-xs uppercase text-gray-500">Total questions</div>
        <div class="text-2xl font-bold mt-1">{{ totalCount }}</div>
      </div>
  
      <div class="border rounded-xl p-4">
        <div class="text-xs uppercase text-gray-500">Affirmations vraies</div>
        <div class="text-2xl font-bold mt-1 text-green-600">
          {{ trueCount }}
          <span class="text-sm text-gray-500">({{ truePercent }}%)</span>
        </div>
      </div>
  
      <div class="border rounded-xl p-4">
        <div class="text-xs uppercase text-gray-500">Affirmations fausses</div>
        <div class="text-2xl font-bold mt-1 text-red-600">
          {{ falseCount }}
          <span class="text-sm text-gray-500">({{ falsePercent }}%)</span>
        </div>
      </div>
    </div>
  
    <!-- Filtres -->
    <div class="flex flex-wrap gap-4 items-center">
      <div>
        <label class="block text-xs text-gray-500 mb-1">Source</label>
        <select
          [(ngModel)]="selectedSource"
          class="border rounded px-3 py-1 text-sm"
        >
          <option value="all">Toutes</option>
          <option value="chat">Chat</option>
          <option value="tiktok">TikTok</option>
          <option value="other">Autres</option>
        </select>
      </div>
  
      <div>
        <label class="block text-xs text-gray-500 mb-1">Verdict</label>
        <select
          [(ngModel)]="selectedTruth"
          class="border rounded px-3 py-1 text-sm"
        >
          <option value="all">Tous</option>
          <option value="true">Vrai</option>
          <option value="false">Faux</option>
        </select>
      </div>
    </div>
  
    <!-- Tableau -->
    <div class="overflow-x-auto border rounded-xl">
      <table class="min-w-full text-sm">
        <thead class="bg-gray-100">
          <tr>
            <th class="text-left p-3">Date</th>
            <th class="text-left p-3">Question</th>
            <th class="text-left p-3">Source</th>
            <th class="text-left p-3">Verdict</th>
            <th class="text-left p-3">Tweets g√©n√©r√©s</th>
          </tr>
        </thead>
        <tbody>
          <tr
            *ngFor="let q of filteredQuestions"
            class="border-t hover:bg-gray-50"
          >
            <td class="p-3 whitespace-nowrap">
              {{ q.createdAt | date : 'short' }}
            </td>
            <td class="p-3">
              {{ q.question }}
            </td>
            <td class="p-3">
              <span
                class="px-2 py-1 rounded-full text-xs"
                [ngClass]="{
                  'bg-blue-100 text-blue-700': q.source === 'chat',
                  'bg-purple-100 text-purple-700': q.source === 'tiktok',
                  'bg-gray-100 text-gray-600':
                    q.source !== 'chat' && q.source !== 'tiktok'
                }"
              >
                {{ q.source }}
              </span>
            </td>
            <td class="p-3">
              <span
                class="px-2 py-1 rounded-full text-xs font-semibold"
                [ngClass]="{
                  'bg-green-100 text-green-700': q.isTrue,
                  'bg-red-100 text-red-700': !q.isTrue
                }"
              >
                {{ q.isTrue ? 'Vrai' : 'Faux' }}
              </span>
            </td>
            <td class="p-3 text-center">
              {{ q.tweets.length }}
            </td>
          </tr>
  
          <tr *ngIf="filteredQuestions.length === 0">
            <td class="p-3 text-center text-gray-400" colspan="5">
              Aucune question ne correspond aux filtres.
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="mt-10">
      <app-survey-stats></app-survey-stats>
    </div>

  </div>
  

